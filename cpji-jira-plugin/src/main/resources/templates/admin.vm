<html>
<head>
    <meta name='decorator' content='atl.admin'>
    <title>Configure Remote Copy Plugin</title>
</head>
<body class="nl">
 <form action="ConfigureCopyIssuesAdminAction!savePermission.jspa" method="post" class="aui">
     <div class="content-body">
        #if ($action.hasConfigChanges())
        <div class="aui-message success">
           <ul>
                #foreach( $change in $action.getConfigChanges() )
                  <li>$change</li>
                #end
            </ul>
       </div>
       #end
       #if ($action.invalidInput())
       <div class="aui-message warning">
             <p>There were some problems when saving the configuration.</p>
             <ul>
                #foreach( $error in $action.getErrorMessages() )
                  <li>$error</li>
                #end
             </ul>
       </div>
       #end
     <h2>General Configuration</h2>
         <div class="field-group">
             <label for"group">User group</label>
             <select class="select" name="group" id="group">
                <option value=""  #if($action.getSelectedGroup() == "") selected="" #end>everyone</option>
                #foreach( $group in $action.getGroups() )
                   <option value="$group.getName()"  #if($action.getSelectedGroup() == $group.getName()) selected="" #end>$group.getName()</option>
                #end
             </select>
             <div class="description">
                 Only users of this group can copy to another JIRA project.
             </div>
         </div>
         <div class="field-group">
             <label for"userMapping">User Mapping</label>
             <select class="select" name="userMapping" id="userMapping">
                #foreach( $userMapping in $action.getUserMappingTypes() )
                   <option value="$userMapping"  #if($action.getConfiguredUserMapping() == $userMapping) selected="" #end>$i18n.getText($userMapping.getI18nKey())</option>
                #end
             </select>
             <div class="description">
               Users from the remote JIRA instance are mapped by using the selected mapping type. This user mapping is used when copying field values of the assignee, comment, reporter, voter and watcher field.
             </div>
         </div>
         <input type="hidden" name="projectKey" value="$action.getProjectKey()"/>
         <div class="buttons-container">
             <div class="buttons">
                <input class="button" type="submit" value="save"/>
             </div>
         </div>
     </div>
 </form>


 <h3>Default values Configuration</h3>
 <form action="ConfigureCopyIssuesAdminAction.jspa" method="post" class="aui">
     <div class="content-body">
     <h2>Issue Type</h2>
         <p>
             Default values are applied when another JIRA instance copies issues to this instance.
             They can be configured per issue type.
         </p>
         <div class="field-group">
             <label for"selectedIssueTypeId">Issue Type</label>
             <select class="select" name="selectedIssueTypeId" id="selectedIssueTypeId">
                #foreach( $issueType in $action.getIssueTypesForProject() )
                   <option value="$issueType.getId()"  #if($action.getSelectedIssueTypeId() == $issueType.getId()) selected="" #end>$issueType.getName()</option>
                #end
             </select>
         </div>
         <input type="hidden" name="projectKey" value="$action.getProjectKey()"/>
         <div class="buttons-container">
             <div class="buttons">
                <input class="button" type="submit" value="select"/>
             </div>
         </div>
     </div>
 </form>

<form action="ConfigureCopyIssuesAdminAction!save.jspa" method="post" class="aui">
    <div class="content-body">
        <h2>Required fields for Issue Type $action.getSelectedIssueTypeName()</h2>
        <p>
            Specify default values for these required fields.
        </p>
        #foreach( $item in $action.getFieldLayoutItems())
          $action.getHtmlForField($item)
        #end
    <input type="hidden" name="projectKey" value="$action.getProjectKey()"/>
    <input type="hidden" name="selectedIssueTypeId" value="$action.getSelectedIssueTypeId()"/>
    <div class="buttons-container">
         <div class="buttons">
            <input type="submit" value="save" class="button"/>
         </div>
    </div>
</form>
</body>
</html>